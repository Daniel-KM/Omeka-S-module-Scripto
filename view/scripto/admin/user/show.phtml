<?php
$this->headLink()->appendStylesheet($this->assetUrl('css/scripto.css', 'Scripto'));
$this->headScript()->appendFile($this->assetUrl('js/scripto.js', 'Scripto'));
$this->htmlElement('body')->appendAttribute('class', 'browse');
?>

<?php echo $this->pageTitle($this->translate('User'), 1, $this->translate('Scripto'), $user['name']); ?>

<?php echo $this->scripto()->adminLoginBar(); ?>

<div class="browse-controls">
    <?php echo $this->scripto()->adminMediawikiPagination(); ?>
</div>

<table class="tablesaw" data-tablesaw-mode="stack">
    <thead>
        <tr>
            <th><?php echo $this->translate('Date'); ?></th>
            <th><?php echo $this->translate('Project'); ?></th>
            <th><?php echo $this->translate('Size'); ?></th>
            <th><?php echo $this->translate('Comment'); ?></th>
        </tr>
    </thead>
    <tbody>
    <?php foreach ($userCons as $userCon): ?>
    <?php
    $date = (new \DateTime($userCon['timestamp']))->format('G:i:s, j F Y');
    $flags = array_filter([
        $userCon['new'] ? $this->translate('new page') : null,
        $userCon['top'] ? $this->translate('current revision') : null,
    ]);
    ?>
        <tr>
            <td>
                <?php echo isset($userCon['scripto_revision_url']) ? $this->hyperlink($date, $userCon['scripto_revision_url']) : $date; ?>
                <?php echo $flags ? sprintf(' (%s)', implode(', ', $flags)) : null; ?>
            </td>
            <td><?php echo isset($userCon['scripto_project'])
                ? $userCon['scripto_project']->link($userCon['scripto_project']->title())
                : 'n/a'; ?></td>
            <td><?php echo sprintf(
                '%s bytes (%s)',
                number_format($userCon['size']),
                sprintf('%s%s', 0 < $userCon['sizediff'] ? '+' : '', number_format($userCon['sizediff']))
            ); ?></td>
            <td><i><?php echo $userCon['parsedcomment']; ?></i></td>
        </tr>
    <?php endforeach; ?>
    </tbody>
</table>
