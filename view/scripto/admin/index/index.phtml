<?php
$this->headLink()->appendStylesheet($this->assetUrl('css/scripto.css', 'Scripto'));
$this->headScript()->appendFile($this->assetUrl('js/scripto.js', 'Scripto'));
$this->htmlElement('body')->appendAttribute('class', 'scripto dashboard');
?>

<?php echo $this->pageTitle($this->translate('Dashboard'), 1, $this->translate('Scripto')); ?>

<?php echo $this->scriptoAuth()->loginBar(); ?>

<div class="dashboard-row">
    <div class="recent-projects panel">
        <h4><?php echo $this->translate('Your recent projects'); ?> <?php echo $this->hyperlink($this->translate('View all'), $this->url('admin/scripto-project'), ['class' => 'button']); ?></h4>
        <?php if ($projects): ?>
        <ul>
        <?php foreach ($projects as $project): ?>
            <li><?php echo $project->link($project->title()); ?></li>
        <?php endforeach; ?>
        </ul>
        <?php else: ?>
        <p><?php echo sprintf(
            $this->translate('No projects found. %s'),
            sprintf(
                '<a href="%s">%s</a>',
                $this->escapeHtml($this->url('admin/scripto-project', ['action' => 'add'])),
                $this->translate('Add a project here.')
            )
        ); ?></p>
        <?php endif; ?>
    </div>
    
    <div class="recent-contributions panel">
        <h4><?php echo $this->translate('Your recent contributions'); ?> <?php echo $this->hyperlink($this->translate('View all'), $this->url('admin/scripto-user-id', ['user-id' => $user['name']]), ['class' => 'button']); ?></h4>
        <?php if (!isset($user['invalid']) && $userCons): ?>
        <ul>
        <?php foreach ($userCons as $userCon): ?>
            <?php $date = (new \DateTime($userCon['timestamp']))->format('G:i:s, j F Y'); ?>
            <li>
                <?php echo isset($userCon['scripto_revision_url']) ? $this->hyperlink($date, $userCon['scripto_revision_url']) : $date; ?>
                <?php echo sprintf('(%s%s)', 0 < $userCon['sizediff'] ? '+' : '', number_format($userCon['sizediff'])); ?>
                <i><?php echo $userCon['parsedcomment']; ?></i>
            </li>
        <?php endforeach; ?>
        </ul>
        <?php else: ?>
        <p><?php echo $this->translate('No contributions found. Do you need to log in to Scripto?'); ?></p>
        <?php endif; ?>
    </div>
</div>