<?php
$this->headLink()->appendStylesheet($this->assetUrl('css/scripto.css', 'Scripto'));
$this->headScript()->appendFile($this->assetUrl('js/scripto.js', 'Scripto'));
$this->htmlElement('body')->appendAttribute('class', 'browse');
?>

<?php echo $this->pageTitle($this->translate('Dashboard'), 1, $this->translate('Scripto')); ?>

<?php echo $this->scriptoAuth()->loginBar(); ?>

<h4><?php echo $this->translate('Your recent projects:'); ?></h4>
<?php if ($projects): ?>
<ul>
<?php foreach ($projects as $project): ?>
    <li><?php echo $project->link($project->title()); ?></li>
<?php endforeach; ?>
    <li><?php echo sprintf('[%s]', $this->hyperlink($this->translate('view all'), $this->url('admin/scripto-project'))); ?></li>
</ul>
<?php else: ?>
<p><?php echo sprintf(
    $this->translate('No projects found. %s'),
    sprintf(
        '<a href="%s">%s</a>',
        $this->escapeHtml($this->url('admin/scripto-project', ['action' => 'add'])),
        $this->translate('Add a project here.')
    )
); ?></p>
<?php endif; ?>

<h4><?php echo $this->translate('Your recent contributions:'); ?></h4>
<?php if (!isset($user['invalid']) && $userCons): ?>
<ul>
<?php foreach ($userCons as $userCon): ?>
    <?php $date = (new \DateTime($userCon['timestamp']))->format('G:i:s, j F Y'); ?>
    <li>
        <?php echo isset($userCon['scripto_revision_url']) ? $this->hyperlink($date, $userCon['scripto_revision_url']) : $date; ?>
        <?php echo sprintf('(%s%s)', 0 < $userCon['sizediff'] ? '+' : '', number_format($userCon['sizediff'])); ?>
        <i><?php echo $userCon['parsedcomment']; ?></i>
    </li>
<?php endforeach; ?>
    <li><?php echo sprintf('[%s]', $this->hyperlink($this->translate('view all'), $this->url('admin/scripto-user-id', ['user-id' => $user['name']]))); ?></li>
</ul>
<?php else: ?>
<p><?php echo $this->translate('No contributions found. Do you need to log in to Scripto?'); ?></p>
<?php endif; ?>
